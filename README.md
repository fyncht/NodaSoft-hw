# NodaSorft-hw

others.php:

Ошибки и улучшения:

 - Конструктор в Contractor::getById:
Использование new self($resellerId) в методе getById не корректно, так как конструктор класса Contractor не определён и не принимает параметры. Это может привести к ошибке. = определить конструктор или изменить реализацию метода getById.

- PHPDoc комментарий @property Seller $Seller:
Комментарий @property в классе Contractor не имеет смысла, так как в классе нет магических методов __get или __set, и свойство Seller не используется. Рекомендуется убрать этот комментарий.

- Метод getRequest напрямую обращается к глобальному массиву $_REQUEST, что представляет риски безопасности (например, XSS или CSRF). Рекомендуется использовать фильтрацию и валидацию данных перед их использованием.

- Функция getResellerEmailFrom не принимает параметров, что может вызвать путаницу, так как ожидается, что она должна принимать идентификатор реселлера. Похожая проблема с getEmailsByPermit, которая не использует передаваемые параметры. 

*result in others_v2.php!*

ReturnOperation:

*Проблемы проектирования:* метод doOperation перегружен логикой и выполняет слишком много задач, что ухудшает читаемость и усложняет тестирование. Отсутствует четкое разделение ответственности.

*Проблемы безопасности:* прямое использование данных из $_REQUEST без их очистки может привести к уязвимостям, таким как XSS или SQL-инъекции.

*Зависимости:* использование статических методов и прямое создание экземпляров классов в методах ухудшает возможность тестирования и расширения кода.


#----------------------------------------------

Комментарии к рефакторингу:

- Разделила doOperation на множество мелких, специализированных приватных методов => улучшили читаемость, облегчили тестирование и поддержку кода.
- Добавила метод validateAndCastData для проверки входных данных => повысили безопасность.
- Использование метода initializeResult для инициализации структуры результата делает код более организованным и понятным.
- Метод loadEntity обеспечивает загрузку и валидацию сущностей
- validateClient и prepareTemplateData отвечают за специфичную для клиента логику валидации и подготовку данных для шаблонов уведомлений соответственно.
- Метод validateTemplateData гарантирует, что все данные для шаблонов заполнены и корректны.
- processNotifications централизует логику отправки уведомлений, делая код более модульным и гибким для изменений.

*Ура! В итоге мы получили читабельный и безопасный код ReturnOperation_v2.php!*
